{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-26T04:54:03.776Z",
  "summary": "The diff implements the core fixes for both REQ-1 (qty×gw weight calculation) and REQ-2 (cache invalidation after split/return). REQ-1 is addressed by renaming the field from weight to weightPerUnit across backend and frontend, and computing total weight as weightPerUnit × quantity in all relevant components. REQ-2 is addressed by defining INVALIDATE_KEYS arrays in SuppliedQtyDialog.tsx and OrderTable.tsx covering all summary query keys, and invalidating them after supply/split/return mutations. Backend summary aggregation in main.mo uses weightPerUnit * quantity. The diff appears largely complete for both requirements, though some details about the backend per-tab summary query endpoints are not fully visible due to truncation.",
  "missing_requirements": [],
  "hallucinated_features": [
    {
      "description": "A migration module (backend/migration.mo) was added to rename the weight field to weightPerUnit with a data upgrade path for existing stored orders.",
      "reason": "The build request only asked to fix the weight formula and cache invalidation. A data migration module was not requested, though it may be necessary for correctness.",
      "evidence": [
        "backend/migration.mo"
      ]
    },
    {
      "description": "A Total Wt (g) column (weightPerUnit x qty) was added to the order tables in ReadyTab, HallmarkTab, and OrderTable as a visible UI column.",
      "reason": "The build request only asked to fix the weight aggregation in summary cards, not to add a new display column to the order tables.",
      "evidence": [
        "frontend/src/components/dashboard/ReadyTab.tsx",
        "frontend/src/components/dashboard/HallmarkTab.tsx",
        "frontend/src/components/dashboard/OrderTable.tsx",
        "frontend-file-summaries.txt"
      ]
    },
    {
      "description": "exportUtils.ts was updated to add a Total Weight (g) column (weightPerUnit x quantity) in Excel exports.",
      "reason": "The build request did not mention changing export functionality — it was scoped to summary card weight calculation and cache invalidation only.",
      "evidence": [
        "frontend/src/utils/exportUtils.ts"
      ]
    }
  ],
  "confidence": 0.72,
  "changed_files": [
    "backend/main.mo",
    "backend/migration.mo",
    "frontend-file-summaries.txt",
    "frontend/src/components/dashboard/HallmarkTab.tsx",
    "frontend/src/components/dashboard/OrderTable.tsx",
    "frontend/src/components/dashboard/ReadyTab.tsx",
    "frontend/src/components/dashboard/SummaryCards.tsx",
    "frontend/src/components/dashboard/SuppliedQtyDialog.tsx",
    "frontend/src/pages/KarigarDetail.tsx",
    "frontend/src/utils/exportUtils.ts",
    "project_state.json"
  ]
}