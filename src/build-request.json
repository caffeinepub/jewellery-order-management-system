{
  "kind": "build_request",
  "title": "Fix Excel parsing to normalize design codes for proper matching",
  "projectName": "Jewellery Order Manager",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Update Excel parsing logic in excelParser.ts to normalize all design codes by trimming whitespace and converting to uppercase before comparison",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Normalize all design codes - trim whitespace and ensure uppercase comparison"
        ]
      },
      "acceptanceCriteria": [
        "Design codes from uploaded Excel files are trimmed of leading/trailing whitespace",
        "Design codes are converted to uppercase for matching (e.g., 'chtmn40952' becomes 'CHTMN40952')",
        "Normalization applies to both Master Design Excel parsing and order Excel parsing"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Update the Master Design Excel parsing to correctly identify Column A as DESIGN CODE, Column B as Generic Name, and Column C as Karigar Name",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "Is Column A labeled 'DESIGN CODE' and contains codes like 'CHTMN40952'?"
        ]
      },
      "acceptanceCriteria": [
        "Column A values are read as design codes",
        "Column B values are read as generic names",
        "Column C values are read as karigar names",
        "Parser validates that these columns exist in the uploaded Excel file"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Automatically update existing orders with matching design codes when Master Design Excel is uploaded, mapping Generic Name and Karigar Name to orders",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Automatically map matching codes when you upload the Excel on the Master Design page",
          "Update existing orders immediately so the Dashboard no longer shows them as unmapped"
        ]
      },
      "acceptanceCriteria": [
        "After Master Design Excel upload, all orders with matching design codes are updated with Generic Name and Karigar Name",
        "Orders that were previously unmapped are removed from the unmapped section if they now have matches",
        "Update happens immediately without requiring manual action"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Display a confirmation message on the Master Design page after Excel upload showing how many design codes were successfully mapped",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Show confirmation of successful mappings"
        ]
      },
      "acceptanceCriteria": [
        "After upload, display a success message with count of mapped design codes",
        "Show count of orders that were updated with new mappings",
        "If any design codes failed to map, display warning with details"
      ]
    }
  ],
  "constraints": [
    "Design codes in the Master Design Excel are in uppercase (Column A)",
    "Column A is DESIGN CODE, Column B is Generic Name, Column C is Karigar Name",
    "Existing Master Design page functionality must be preserved",
    "Single-actor Motoko backend architecture must be maintained"
  ],
  "nonGoals": [
    "Changing the Excel file format or column structure",
    "Adding new columns beyond the three specified",
    "Supporting case-sensitive design code matching",
    "Creating a new Master Design page (it already exists)"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}